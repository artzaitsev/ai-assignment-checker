services:
  api:
    command: ["sh", "-c", "uv sync --all-groups && uv run python -m app.main --role api --port 8000"]
    volumes:
      - ./:/app

  worker-ingest-telegram:
    profiles: ["full"]
    command: ["sh", "-c", "uv sync --all-groups && uv run python -m app.main --role worker-ingest-telegram --port 8101"]
    volumes:
      - ./:/app

  worker-normalize:
    profiles: ["full"]
    command: ["sh", "-c", "uv sync --all-groups && uv run python -m app.main --role worker-normalize --port 8102"]
    volumes:
      - ./:/app

  worker-llm:
    profiles: ["full"]
    command: ["sh", "-c", "uv sync --all-groups && uv run python -m app.main --role worker-llm --port 8103"]
    volumes:
      - ./:/app

  worker-deliver:
    profiles: ["full"]
    command: ["sh", "-c", "uv sync --all-groups && uv run python -m app.main --role worker-deliver --port 8104"]
    volumes:
      - ./:/app
